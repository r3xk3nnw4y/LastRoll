{% extends "shop/base.html" %}
{% block title %}Reported Listings{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2 class="text-center mb-4">Reported Listings</h2>

  {% for product in reports %}
  <div class="card mb-4 shadow-sm p-3">
    <div class="d-flex align-items-center">
      {% if product.image %}
        <img src="{{ product.image.url }}" alt="{{ product.name }}"
             class="img-thumbnail mr-3" style="width: 150px; height: auto;">
      {% endif %}
      <div>
        <h5 class="card-title mb-1">{{ product.name }}</h5>
        <p class="card-text text-muted mb-1">{{ product.description|truncatewords:20 }}</p>

        <!-- ðŸ”¹ Seller info -->
        <p class="mb-1"><strong>Store Name:</strong> {{ product.seller.store_name|default:"N/A" }}</p>
        <p class="mb-1"><strong>Seller Username:</strong> {{ product.seller.user.username }}</p>

        <p class="mb-1"><strong>Reported:</strong> {{ product.is_reported }}</p>
        <p class="mb-1">
          <strong>Status:</strong>
          {% if product.report_confirmed %}
            <span class="text-danger font-weight-bold">Confirmed (Hidden)</span>
          {% else %}
            <span class="text-warning font-weight-bold">Pending Review</span>
          {% endif %}
        </p>
      </div>
    </div>

    <div class="mt-3">
      <form action="{% url 'resolve_report' product.pk 'confirm' %}" method="post" style="display:inline;">
        {% csrf_token %}
        <button class="btn btn-danger btn-sm">Confirm Report</button>
      </form>
      <form action="{% url 'resolve_report' product.pk 'dismiss' %}" method="post" style="display:inline;">
        {% csrf_token %}
        <button class="btn btn-success btn-sm">Dismiss Report</button>
      </form>
    </div>
  </div>
  {% empty %}
    <p class="text-center text-muted">No reported listings found.</p>
  {% endfor %}
</div>
{% endblock %}
